<div class="container marketing py-4">
    <nav aria-label="breadcrumb ">
        <ol class="breadcrumb mt-2">
            <li class="breadcrumb-item"><a routerLink="/home">Home</a></li>
            <li class="breadcrumb-item"><a routerLink="/carrito">Carrito</a></li>
            <li class="breadcrumb-item active" aria-current="page">Checkout</li>
        </ol>
    </nav>
    <div class="bg-white py-4">
        <ng-container>
            <div class="row">
                <div class="col-sm-6">
                    <h4>Datos de envío</h4>
                    <hr>  
                    <form class="" (ngSubmit)="save(customer)" #customer="ngForm">
                        <div class="row">
                            <div class="col-sm-12 animate__animated animate__fadeInUp animate__faster animate__delay-1s">
                                <div class="form-group">
                                    <label>Nombre completo</label>
                                    <input type="text" class="form-control" [(ngModel)]="loginService.user.name" name="name" placeholder="">
                                </div>
                            </div>
                            <div class="col-sm-6 animate__animated animate__fadeInUp animate__faster animate__delay-2s">
                                <div class="form-group">
                                    <label>Provincia</label>
                                    <select  class="form-control" [(ngModel)]="form.provence" name="provence" (change)="onChange(false)">
                                        <option value=''>--Seleccione una opción--</option>
                                        <option value="{{ provence.id }}" *ngFor="let provence of provences; let i=index;" >{{ provence.name }}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-sm-6 animate__animated animate__fadeInUp animate__faster animate__delay-2s">
                                <div class="form-group">
                                    <label>Localidad</label>
                                    <ng-container *ngIf="!loadingLocalities">
                                        <select  class="form-control" [(ngModel)]="form.locality" name="locality" >
                                            <option value=''>--Seleccione una opción--</option>
                                            <option value="{{ locality.id }}" *ngFor="let locality of localities; let i=index;" >{{ locality.name }} ({{ locality.department.name }})</option>
                                        </select>
                                    </ng-container>
                                    <ng-container *ngIf="loadingLocalities">
                                        <div  class="text-center">
                                            <i class="fa fa-refresh fa-spin fa-2x fa-fw"></i>
                                        </div>
                                    </ng-container>
                                </div>
                            </div>
                            <div class="col-sm-12 animate__animated animate__fadeInUp animate__faster animate__delay-3s">
                                <div class="form-group">
                                    <label>Calle</label>
                                    <input type="text" class="form-control" [(ngModel)]="loginService.user.street" name="street" placeholder="">
                                </div>
                            </div>
                            <div class="col-sm-3 animate__animated animate__fadeInUp animate__faster animate__delay-4s">
                                <div class="form-group">
                                    <label>Número</label>
                                    <input type="text" class="form-control" [(ngModel)]="loginService.user.streetNumber" name="streetNumber" placeholder="">
                                </div>
                            </div>
                            <div class="col-sm-3 animate__animated animate__fadeInUp animate__faster animate__delay-4s">
                                <div class="form-group">
                                    <label>Código postal</label>
                                    <input type="text" class="form-control" [(ngModel)]="loginService.user.postalCode" name="postalCode" placeholder="">
                                </div>
                            </div>
                            <div class="col-sm-3 animate__animated animate__fadeInUp animate__faster animate__delay-4s">
                                <div class="form-group">
                                    <label>Dpto</label>
                                    <input type="text" class="form-control" [(ngModel)]="loginService.user.department" name="department" placeholder="">
                                </div>
                            </div>
                            <div class="col-sm-3 animate__animated animate__fadeInUp animate__faster animate__delay-4s">
                                <div class="form-group">
                                    <label>Piso</label>
                                    <input type="text" class="form-control" [(ngModel)]="loginService.user.floor" name="floor" placeholder="">
                                </div>
                            </div>
                        </div>
                        <hr class="animate__animated animate__fadeInUp animate__faster animate__delay-5s">
                        <div class="text-center my-4 animate__animated animate__fadeInUp animate__faster animate__delay-6s">
                            <button type="submit" class="btn btn-info align-center">Confirmar pedido</button>
                        </div>
                    </form> 
                </div>
                <div class="col-sm-6">
                    <h4>Confirma tu pedido</h4>
                    <hr>
                    <div class="card my-3 animate__animated animate__fadeInUp animate__faster animate__delay-{{ i+1 }}s" *ngFor="let item of loginService.user.cart.items; let i=index;">
                        <app-checkout-item [item]="item"></app-checkout-item>
                    </div>
                    <div class="text-right mt-3 mb-3  animate__animated animate__fadeInUp animate__faster animate__delay-5s">
                        <h4 class="mb-1"> Total : {{ loginService.user.cart.total | formatNumber }} </h4>
                        <h4 class="mb-1"> Costo de envío : {{ 0 | formatNumber }} </h4>
                        <h4 class="mb-1"> Crédito : {{ loginService.user.balance | formatNumber }} </h4>
                        <h4 class="mb-1" [ngClass]="(loginService.user.balance - this.loginService.user.cart.total) > 0 ? 'text-success' : 'text-danger' "> Saldo : {{ (loginService.user.balance - loginService.user.cart.total) | formatNumber }} </h4>
                    </div>   
                </div>
            </div>
        </ng-container>
    </div>
</div>